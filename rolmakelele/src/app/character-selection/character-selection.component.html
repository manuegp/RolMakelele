<div class="container">
  <ng-container *ngIf="getPlayersCount === 2; else waiting">
    <h2 class="mb-3">Elige 4 personajes</h2>
    <div class="row">
      <div class="col-md-3 mb-3" *ngFor="let char of characters">
        <div class="card" [class.border-primary]="selected.find(c => c.id === char.id)">
          <div class="card-body">
            <h5 class="card-title">{{ char.name }}</h5>
            <button class="btn btn-sm btn-outline-primary" (click)="toggle(char.id)">
              {{ selected.find(c => c.id === char.id) ? 'Quitar' : 'Añadir' }}
            </button>
            <div class="mt-2" *ngIf="selected.find(c => c.id === char.id)">
              <app-ability-selector
                [characterId]="char.id"
                [selectedIds]="selected.find(c => c.id === char.id)?.abilities || []"
                (selectionChange)="onAbilitySelectionChange(char.id, $event)"
              ></app-ability-selector>
            </div>
          </div>
        </div>
      </div>
    </div>
    <button
      class="btn btn-primary"
      [disabled]="!(selected.length === 4 && selected.every(c => c.abilities.length === 4))"
      (click)="ready()"
    >
      {{ isReady ? 'Volver a seleccionar' : 'Estoy listo' }}
    </button>
    <button class="btn btn-secondary ms-2" (click)="leave()">Salir</button>
  </ng-container>
  <ng-template #waiting>
    Esperando a que se unan más jugadores...
  </ng-template>
</div>
